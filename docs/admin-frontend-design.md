# Cyber-Range 后台前端页面设计文档

## 1. 目标与范围
- **目标**：输出“后台管理端（Admin Console）”的前端页面信息架构、页面线框结构、字段与表格列、交互规范与状态规范，作为后续实现依据。
- **范围**：仅前端页面设计与交互，不包含后端接口落地与数据库设计。
- **技术约束（基于现状）**：前端使用 React + TypeScript + Ant Design；路由使用 React Router（当前项目已存在路由与主布局体系）。

## 2. 关键设计决策（已确认）
- **题库新建/编辑形态**：新建用独立页面；编辑用右侧 Drawer。
- **主题**：沿用 Ant Design 默认浅色主题。
- **内容编辑**：题目描述/提示使用 WYSIWYG 富文本编辑器。
- **详情查看**：实例管理/提交记录的详情使用 Drawer（不跳转详情页）。
- **后台首页**：偏“数据看板”为主。
- **菜单**：6 项，其中 Users/Settings 置灰不可点并显示 Tooltip“建设中”。
- **题库列表列**：默认精简，但支持“列设置”勾选显示/隐藏更多列。
- **Flag 展示**：默认不展示；点击“查看 Flag”需二次确认后才显示并可复制。
- **上下架交互**：Switch + 操作菜单按钮双入口（都带确认）。
- **标题点击行为**：点击题目标题直接打开编辑 Drawer。
- **实例访问地址展示**：列表页不展示访问链接，仅在详情 Drawer 可复制。
- **提交记录默认信息**：偏审计（时间/用户/题目/结果/IP）。
- **题库行操作默认露出**：编辑 + 上下架 + 删除，其余在“更多(…)”。

## 3. 信息架构（Routes）
### 3.1 路由树
- `/admin/login`：后台登录
- `/admin`：后台主框架（AdminLayout）
  - `/admin/overview`：总览
  - `/admin/challenges`：题库列表
  - `/admin/challenges/new`：新建挑战（页面）
  - `/admin/instances`：实例管理
  - `/admin/submissions`：提交记录
  - `/admin/users`：建设中（置灰不可点）
  - `/admin/settings`：建设中（置灰不可点）

### 3.2 导航菜单（Sider Menu）
- 总览（Overview）
- 题库（Challenges）
- 实例（Instances）
- 提交记录（Submissions）
- 用户管理（Users，置灰 + Tooltip：建设中）
- 系统设置（Settings，置灰 + Tooltip：建设中）

## 4. 全局布局与通用规范

### 4.1 AdminLayout（后台框架）
- **Header**
  - 左侧：产品名 “Cyber-Range Admin”
  - 右侧：当前管理员（头像/名称占位）+ 退出按钮
- **Sider**
  - 菜单项与当前路由联动高亮
  - 置灰项：不可点击 + Hover Tooltip“建设中”
- **Content**
  - 统一使用 PageHeader（标题 + 操作区）
  - 页内统一间距：筛选区（FilterBar）→ 主内容（Table/Form）→ 分页

### 4.2 通用交互反馈
- 成功：使用 message 成功提示（短）
- 失败：message 错误提示 + 表单字段高亮（如有）
- 危险操作：统一 Modal.confirm 二次确认（删除、强制停止、查看 Flag）
- Loading：表格 loading；Drawer/页面保存按钮 loading；空状态使用 Empty

### 4.3 空状态与错误状态规范
- 空数据：Empty（可带“新建挑战”快捷按钮，仅题库列表）
- 无权限：403 空状态（说明需管理员权限）
- 未登录：跳转 `/admin/login`
- 网络错误：Error Alert + 重试按钮（列表页可置于筛选区右侧）

## 5. 页面设计明细

## 5.1 `/admin/login`（后台登录页）
### 页面结构（线框）
- 居中 Card
  - 标题：管理员登录
  - 表单：
    - 用户名/邮箱
    - 密码
    - 记住我（可选）
  - 登录按钮（Primary）
  - 错误提示区域（Alert，登录失败时显示）

### 校验与交互
- 字段必填校验
- 登录成功：跳转 `/admin/overview`
- 登录失败：显示错误原因（通用文案即可）

## 5.2 `/admin/overview`（总览 - 数据看板）
### 页面结构（线框）
- PageHeader：总览
- 统计卡片（4 个）
  - 今日启动实例数
  - 运行中实例数
  - 今日提交数
  - 今日正确率
- 两列内容区
  - 左：最近提交（Table 简版：时间/用户/题目/结果）
  - 右：题目热度 Top5（列表或条形图）
- 可选：系统健康（占位卡片）

### 交互
- 统计卡片点击可跳转到对应列表筛选视图（后续可选）
- 最近提交点击行打开提交详情 Drawer（同 submissions 详情）

## 5.3 `/admin/challenges`（题库列表）
### 页面结构（线框）
- PageHeader：题库管理
  - 左：标题
  - 右：新建挑战（Primary）、列设置（按钮/Popover）
- FilterBar
  - 关键字搜索（标题/ID）
  - 分类（Select）
  - 难度（Select）
  - 状态（上架/下架）
  - 查询/重置按钮
- Table（分页）

### 表格列（默认精简）
- 标题（可点击，打开编辑 Drawer）
- 分类
- 难度
- 分值
- 状态（Tag + Switch）
- 更新时间
- 操作（编辑 / 上下架 / 删除 / 更多）

### 列设置（Column Settings）
- 默认展示“精简列”
- 可勾选展示更多列（建议默认隐藏）：
  - 镜像（Image）
  - 端口（Port）
  - 创建人（Owner，占位）
  - 上架时间（PublishedAt）
  - 下架时间（UnpublishedAt）
  - 版本号（Version，占位）
- 交互建议：
  - Popover 内 Checkbox 列表
  - 支持“恢复默认”
  - 列配置本地存储（localStorage）即可（实现阶段）

### 行操作与确认
- 编辑：打开编辑 Drawer
- 上下架：按钮与 Switch 都存在，两者都需二次确认
- 删除：Danger + 二次确认（确认文案提示不可恢复）
- 更多（…）：复制挑战（可选）、再次提供上下架、其他扩展入口

## 5.4 题库编辑 Drawer（从题库列表进入）
### Drawer 基本规格
- 位置：右侧
- 宽度：建议 720–960（按内容自适应）
- Footer：保存 / 取消（保存按钮带 loading）

### Tabs（信息组织）
1. **基本信息**
   - 标题（必填）
   - 分类（必填）
   - 难度（必填）
   - 分值（必填，正整数）
   - 简介（可选，短文本）
   - 封面图（可选，先占位）
2. **内容（富文本）**
   - 题目描述（WYSIWYG，必填或建议必填）
   - 提示（WYSIWYG，可选）
3. **运行配置**
   - 镜像地址（必填，例如 repo:tag）
   - 容器端口（默认 80，数值校验）
   - 环境变量（Key/Value 列表，可增删行）
4. **Flag**
   - 默认：不展示 Flag 明文
   - 操作：按钮“查看 Flag”
     - 点击后 Modal.confirm 二次确认
     - 确认后展示 Flag 明文 + 复制按钮
     - 可选：再次隐藏按钮
5. **状态**
   - 上架/下架（与列表一致）
   - 可显示最近上架/下架时间（若有）

### 富文本编辑器（WYSIWYG）设计要求
- 支持：加粗/斜体/标题/列表/代码块/链接/图片（图片可先不实现上传，仅占位）
- 内容存储：建议保存为 HTML（或 Markdown + 渲染，需二选一；本设计按 WYSIWYG 常见做法偏 HTML）
- 安全：预览与展示需做 XSS 防护（实现阶段）

## 5.5 `/admin/challenges/new`（新建挑战页面）
### 页面结构（线框）
- PageHeader：新建挑战
  - 返回题库列表
  - 保存 / 保存并上架 / 取消
- 表单主体
  - 建议 Tabs 结构与编辑 Drawer 一致，保证学习成本一致

### 校验与交互
- 必填项：标题、分类、难度、分值、镜像、端口（默认）、描述
- 保存成功：返回题库列表并高亮/定位新建项（可选）

## 5.6 `/admin/instances`（实例管理）
### 页面结构（线框）
- PageHeader：实例管理
- FilterBar
  - 状态（running/stopped）
  - 题目（Select，后续支持搜索）
  - 时间范围（创建时间）
  - 查询/重置
- Table（分页）

### 表格列（默认）
- 实例 ID
- 题目
- 用户（占位，可先不展示或显示 `-`）
- 状态（Tag）
- 创建时间
- 操作（查看 / 强制停止）

### “访问地址”展示规则（隐私/安全优先）
- 列表页：不展示访问链接或 host:port
- 详情 Drawer：展示可复制访问地址（并可设置权限/脱敏，实施阶段再定）

### 实例详情 Drawer
- 基本信息：实例ID、容器ID、镜像、端口映射、状态、创建时间
- 访问（仅详情）：复制访问地址按钮
- 操作：强制停止（Danger + 二次确认）

## 5.7 `/admin/submissions`（提交记录）
### 页面结构（线框）
- PageHeader：提交记录
- FilterBar
  - 用户（输入或 Select）
  - 题目（Select）
  - 结果（正确/错误）
  - 时间范围
  - 查询/重置
- Table（分页）

### 表格列（审计向默认）
- 时间
- 用户
- 题目
- 结果（Tag：Correct/Wrong）
- IP（如有）
- 操作（查看详情）

### 提交详情 Drawer
- 基本信息：提交时间、用户、题目、结果、IP（如有）
- 关联信息：关联实例ID（如有）、得分变化（如有）
- 安全约束：不展示 Flag 明文；若必须展示需脱敏并限制权限（默认不展示）

## 6. 权限与可见性（前端行为）
- 未登录访问 `/admin/*`：跳转 `/admin/login`
- 已登录但非管理员：
  - 进入后台：展示 403 或跳转到前台首页（实现时二选一）
- “建设中”菜单：
  - 置灰不可点击，仅 Tooltip 提示“建设中”

## 7. 组件复用清单（建议）
- AdminLayout（后台骨架）
- FilterBar（统一筛选条样式）
- DataTable（统一表格：loading/空状态/分页）
- ColumnSettings（列设置 Popover）
- ConfirmableAction（统一二次确认动作包装）
- RichTextEditor（富文本编辑器封装组件）
- EntityDrawerShell（统一 Drawer 标题/页脚/加载态）

## 8. 视觉与文案规范（轻量）
- 状态 Tag：
  - 上架：绿色
  - 下架：灰色
  - running：蓝色
  - stopped：灰色
  - correct：绿色
  - wrong：红色
- 危险操作文案统一：
  - 删除：提示“不可恢复”
  - 强制停止：提示“可能影响正在使用的用户环境”
  - 查看 Flag：提示“请确认你具备查看权限，避免泄露”

